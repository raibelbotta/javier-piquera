;App=typeof App!=='undefined'?App:{};+(App.Main=function(e){'use strict';var t,n=function(){e('#side-menu').metisMenu()},i=function(){var n=50,i=(this.window.innerWidth>0)?this.window.innerWidth:this.screen.width;if(i<768){e('div.navbar-collapse').addClass('collapse');n=100}
else{e('div.navbar-collapse').removeClass('collapse')};var t=((this.window.innerHeight>0)?this.window.innerHeight:this.screen.height)-1;t=t-n;if(t<1)t=1;if(t>n){e('#page-wrapper').css('min-height',(t)+'px')}},o=function(){e(window).on('load resize',i)},a=function(){var t=window.location,n=e('ul.nav a').filter(function(){return this.href==t||t.href.indexOf(this.href)==0}).addClass('active').parent().parent().addClass('in').parent();if(n.is('li')){n.addClass('active')}},s=function(){if(e.fn.tooltipster){e('[title]').not('.cke *').tooltip({'trigger':'hover'})}
else{console.log('Tooltip plugin not present')}},r=function(t,n){e(t).each(function(){var t=e(this);t.validate(e.extend({},{errorElement:'span',errorClass:'error',errorPlacement:function(n,t){if(t.is(':hidden')){t=t.parent()}
else if(t.is('.select2-hidden-accessible')){t=t.parent().find('.select2-container')};if(!t.data('tooltipster-ns')){t.tooltipster({trigger:'custom',onlyOne:!1,position:'bottom-left',positionTracker:!0})};t.tooltipster('update',e(n).text());t.tooltipster('show')},success:function(n,t){if(e(t).is(':hidden')){t=e(t).parent()}
else if(e(t).is('.select2-hidden-accessible')){t=e(t).parent().find('.select2-container')};e(t).tooltipster('hide')}},n))})},d=function(){if(e.datepicker){var n={prevText:'Anterior',nextText:'Siguiente',monthNames:['Enero','Febrero','Marzo','Abril','Mayo','Junio','Julio','Agosto','Septiembre','Octubre','Noviembre','Deciembre'],monthNamesShort:['Ene','Feb','Mar','Apr','May','Jun','Jul','Ago','Sep','Oct','Nov','Dic'],dayNames:['Domingo','Lunes','Martes','Miércoles','Jueves','Viernes','Sábado'],dayNamesShort:['Dom','Lun','Mar','Mie','Jue','Vie','Sáb'],dayNamesMin:['Do','Lu','Ma','Mi','Ju','Vi','Sá'],weekHeader:'sem',firstDay:1,dateFormat:'dd/mm/yy',changeMonth:!0,changeYear:!0,currentText:'Ahora',closeText:'Listo',amNames:['AM','A'],pmNames:['PM','P'],timeFormat:'HH:mm',timeSuffix:'',timeOnlyTitle:'Seleccionar hora',timeText:'Time',hourText:'Hora',minuteText:'Minuto',secondText:'Segundo',controlType:'slider',showTime:!1};var t=e.fn.datepicker.noConflict();e('.datetimepicker').each(function(){var t=e(this);t.datetimepicker(n)});e.fn.datepicker=t}
else{console.log('Datepicker is not present')}},c=function(){e('a.link-report').on('click',function(n){n.preventDefault();var i=e('#_mR');if(!i.length){i=e('<div id="_mR"/>').appendTo(e('body'))};if(t){e(this).append(e('<img src="__src__" class="pull-right"/>'.replace(/__src__/,t)))};var o=e(this);i.empty().load(e(this).attr('href'),function(){i.find('.modal').modal();o.find('img').remove()})})},l=function(t){t.preventDefault();var n=e(this).attr('href');e('.modal[data-for=message] .modal-body').empty().append(e('<div class="row"><div class="col-xs-12">Cargando mensaje..</div></div>'));e('.modal[data-for=message]').off('shown.bs.modal').on('shown.bs.modal',function(){e(this).find('.modal-body').load(n)}).modal();e(this).parents('li:first').remove()},p=function(){e('a.link-message').on('click',l)},f=function(){e('body').on('click','a#linkGenerateWeekPdfs',function(t){t.preventDefault();e('#_aK').remove();var n=e('<div id="_aK" class="modal fade"><div class="modal-dialog"><div class="modal-content"></div></div></div>').appendTo(e('body'));n.find('.modal-content').load(e(this).attr('href'),function(){n.modal({backdrop:'static'})})});e('body').on('click','.btn-generate-week-conceal',function(){e(this).empty().append(e('<span class="fa fa-check-square"/>'))});e('.dropdown-tasks').parent().on('shown.bs.dropdown',function(){e(this).find('.dropdown-tasks').empty().append(e('<li><div><p class="text-center">Cargando...</p></div></li>')).load(Routing.generate('app_default_gettasksdropdowncontent'))})},u=function(){e.extend(!0,e.fn.dataTable.defaults,{iDisplayLength:200,aLengthMenu:[10,20,50,100,200,400,800,1000],oLanguage:{'sProcessing':'Procesando...','sLengthMenu':'Mostrar _MENU_ registros','sZeroRecords':'No se encontraron resultados','sEmptyTable':'Ningún dato disponible en esta tabla','sInfo':'Mostrando del _START_ al _END_ (de _TOTAL_)','sInfoEmpty':'Mostrando registros del 0 al 0 de un total de 0 registros','sInfoFiltered':'(filtrado de un total de _MAX_ registros)','sInfoPostFix':'','sSearch':'Buscar:','sUrl':'','sInfoThousands':',','sLoadingRecords':'Cargando...','oPaginate':{'sFirst':'Primero','sLast':'Último','sNext':'Siguiente','sPrevious':'Anterior'},'oAria':{'sSortAscending':': Activar para ordenar la columna de manera ascendente','sSortDescending':': Activar para ordenar la columna de manera descendente'}}})},m=function(){e('input:checkbox.icheck').iCheck({checkboxClass:'icheckbox_flat-blue'})};return{init:function(i){i=e.extend({loadingImageSrc:!1,notices:[],},i);t=i.loadingImageSrc;n();o();a();s();d();c();p();f();u();m();if(i.notices.length>0){e.each(i.notices,function(e,t){toastr.success(t,'Éxito',{timeOut:5000,progressBar:!0})})}},validate:r}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Cobros=typeof App.Cobros!=='undefined'?App.Cobros:{};+(App.Cobros.Index=function(e){var t,o=function(){if(e.fn.tooltip){e(this).find('[title]').tooltip({trigger:'hover'})};e(this).unblock();e(this).find('input:checkbox').iCheck({checkboxClass:'icheckbox_flat-blue'})},a=function(){var a=e('#dataTables-cobros'),n={'aoColumns':[{width:'10px'},{name:'serialNumber',title:'Número'},{name:'startAt',title:'Fecha'},{name:'provider',title:'Cliente'},{name:'providerReference',title:'Referencia'},{name:'clientNames',title:'Nombre(s)'},{name:'serviceType',title:'Tipo de servicio'},{name:'price',title:'Importe'}],columnDefs:[{targets:[0,1,4,5,7],sortable:!1}],aaSorting:[[2,'asc']],searching:!1,serverSide:!0,processing:!1,ajax:{data:function(t){var o=[];e.each(e('#frmFilter').serializeArray(),function(e,t){o[t['name']]=t['value']});return e.extend(!0,t,o)},method:'GET',url:a.data('ajax-url')}};a.on('draw.dt',o).on('preDraw.dt',function(){e(this).block({'message':'Procesando...'})});t=a.dataTable(n)},n=function(){if(e.validator){e.validator.addMethod('validdecimal',function(e,t){return this.optional(t)||/^((.|,)\d{1,2}|\d+(|.(|\d{1,2})|,(\d{1,2})))$/.test(e)},'Valor no válido')}
else{console.log('Validator plugin not present')}},r=function(){App.Main.validate(e('.modal[data-for=cobrar-op] form'))},i=function(t){t.preventDefault();if(e('#dataTables-cobros').find('input:checkbox:checked').length==0){toastr.error('Debe seleccionar registros para esta operación','Error',{timeOut:5000,progressBar:!0});return};var o=[];e('#dataTables-cobros').find('input:checkbox:checked').each(function(){o.push(this.value)});e('.modal[data-for=cobrar-op] .modal-body').empty().text('Cargando información de servicios seleccionados...');e('.modal[data-for=cobrar-op]').modal();e('.modal[data-for=cobrar-op] div.modal-body').load(e(this).attr('href'),{ids:o},r)},c=function(t){t.preventDefault();e(this).parents('.modal-content:first').find('form').submit();e(this).off('click').text('Guardando información...')},l=function(t){t.preventDefault();var a=e(this).data('url'),o=e('.modal[data-for=cobrar-op] form').clone();o.attr({action:a,method:'post',target:'_blank'}).appendTo(e('body')).submit();setTimeout(function(){o.remove()},100)},d=function(){e('.modal[data-for=cobrar-op] .btn-success').on('click',c);e('.modal[data-for=cobrar-op] .btn-print').on('click',l)},s=function(t){t.preventDefault();e('#dataTables-cobros input:checkbox').prop('checked',!0).iCheck('update')},p=function(t){t.preventDefault();e('#dataTables-cobros input:checkbox').prop('checked',!1).iCheck('update')},f=function(){e('#linkCobrar').on('click',i);e('#linkSelectAll').on('click',s);e('#linkSelectNone').on('click',p)},u=function(){e('#modal-historico button.btn-primary').on('click',function(t){t.preventDefault();e('#modal-historico .modal-body form').submit();e('#modal-historico').modal('hide')});e('#modal-historico select').select2({language:'./i18n/es',width:'style'})},m=function(){e('#frmFilter input.datepicker').on('change',function(){t.DataTable().draw()}).datepicker({autoclose:!0,clearBtn:!0,format:'dd/mm/yyyy'});e('#frmFilter select').on('change',function(){t.DataTable().draw()});e('#frmFilter input:text').on('keyup',function(){t.DataTable().draw()})};return{init:function(){a();f();d();n();u();m()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Control=typeof App.Control!=='undefined'?App.Control:{};App.Control.Clasicos=typeof App.Control.Clasicos!=='undefined'?App.Control.Clasicos:{};+(App.Control.Clasicos.Index=function(e){'use strict';var t=e('table#table-xs'),n=function(){t.on('preDraw.dt',function(){e(this).block({message:'Procesando...'})}).on('draw.dt',function(){e(this).find('[title]').tooltip({'trigger':'hover'});e(this).unblock()}).DataTable({aoColumns:[{'name':'startAt',title:'Inicio'},{name:'serial',title:'Número'},{name:'clientName',title:'Cliente'},{name:'clientReference',title:'Referencia'},{name:'providerName',title:'Conductor'},{'name':'serviceType',title:'Servicio'},{'name':'control','searchable':!1,'sortable':!1}],'aaSorting':[[0,'asc']],'aLengthMenu':[200,400,800,1000],'responsive':!0,'bServerSide':!0,'bProcessing':!1,'ajax':{'method':'GET','url':Routing.generate('app_control_clasicos_getdata')},ordering:!1})},o=function(n){var o=e(this);o.attr('disabled','disabled');n.preventDefault();e('#dR').remove();var t=e('<div class="modal fade in"/>').append('<div class="modal-dialog"><div class="modal-content"></div></div>');t.find('.modal-content').load(e(this).attr('href'),function(){t.find('form').ajaxForm({target:t.find('.modal-content')});t.modal();o.removeAttr('disabled')})},a=function(){t.on('click','.btn-control',o)};return{init:function(){n();a()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Control=typeof App.Control!=='undefined'?App.Control:{};App.Control.Guia=typeof App.Control.Guia!=='undefined'?App.Control.Guia:{};+(App.Control.Guia.Index=function(e){'use strict';var t=e('#table-xs'),n=function(n){n.preventDefault();e('#dR').remove();var t=e('<div class="modal fade in"/>').append('<div class="modal-dialog"><div class="modal-content"></div></div>');t.find('.modal-content').load(e(this).attr('href'),function(){t.find('form').ajaxForm({target:t.find('.modal-content')});t.modal()})},o=function(){t.on('click','.btn-control',n)},a=function(){t.on('preDraw.dt',function(){e(this).block({message:'Procesando...'})}).on('draw.dt',function(){e(this).find('[title]').tooltip({'trigger':'hover'});e(this).unblock()}).DataTable({aoColumns:[{'name':'startAt',title:'Inicio'},{name:'serial',title:'Número'},{name:'clientName',title:'Cliente'},{name:'clientReference',title:'Referencia'},{name:'providerName',title:'Guía'},{name:'serviceType',title:'Servicio'},{name:'control',searchable:!1,sortable:!1}],'aaSorting':[[0,'asc']],'aLengthMenu':[200,400,800,1000],'responsive':!0,bServerSide:!0,bProcessing:!1,ajax:{method:'GET',url:Routing.generate('app_control_guia_getdata')}})};return{init:function(){a();o()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Control=typeof App.Control!=='undefined'?App.Control:{};App.Control.Ordinarios=typeof App.Control.Ordinarios!=='undefined'?App.Control.Ordinarios:{};+(App.Control.Ordinarios.Index=function(e){'use strict';var t=e('#table-xs'),n=function(n){n.preventDefault();e('#dR').remove();var t=e('<div class="modal fade in"/>').append('<div class="modal-dialog"><div class="modal-content"></div></div>');t.find('.modal-content').load(e(this).attr('href'),function(){t.find('form').ajaxForm({target:t.find('.modal-content')});t.modal()})},o=function(){t.on('click','.btn-control',n)},i=function(){t.on('preDraw.dt',function(){e(this).block({message:'Procesando...'})}).on('draw.dt',function(){e(this).find('[title]').tooltip({'trigger':'hover'});e(this).unblock()}).DataTable({aoColumns:[{name:'startAt',title:'Inicio'},{name:'provider',title:'Cliente'},{name:'serialNumber',title:'Número'},{name:'providerReference',title:'Referencia'},{name:'clientNames',title:'Nombre(s)'},{name:'pax',searchable:!1,title:'PAX'},{name:'serviceType',title:'Servicio'},{name:'driver',title:'Conductor'},{name:'guide',title:'Guía',searchable:!1,sortable:!1},{name:'control',title:'Control',searchable:!1,sortable:!1}],'aaSorting':[[0,'asc']],'aLengthMenu':[200,400,800,1000],'responsive':!0,bServerSide:!0,bProcessing:!1,ajax:{method:'GET',url:Routing.generate('app_control_getdata')}})};return{init:function(){i();o()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Drivers=typeof App.Drivers!=='undefined'?App.Drivers:{};+(App.Drivers.Form=function(e){var n=function(){App.Main.validate(e('form#driver'))},i=function(){e('form#driver input:checkbox').iCheck({checkboxClass:'icheckbox_flat-blue'});e('form#driver input[type=tel]').intlTelInput({allowExtensions:!0,autoFormat:!1,autoHideDialCode:!0,autoPlaceholder:!1,defaultCountry:'auto',geoIpLookup:function(n){e.get('http://ipinfo.io',function(){},'jsonp').always(function(e){var i=(e&&e.country)?e.country:'';n(i)})},nationalMode:!1,numberType:'MOBILE',preferredCountries:['cu'],utilsScript:'/plugins/jquery.intlTelInput/libphonenumber/build/utils.js'})};return{init:function(){n();i()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Drivers=typeof App.Drivers!=='undefined'?App.Drivers:{};+(App.Drivers.Index=function(e,a){'use strict';var t=e('table#dataTables-drivers'),n=function(){t.on('preDraw.dt',function(){e(this).block({message:'Cargando datos...'})}).on('draw.dt',function(){e(this).unblock()});t.DataTable({ajax:{data:function(t){var a=[];e.each(e('#formFilter').serializeArray(),function(e,t){a[t.name]=t.value});return e.extend(!0,t,a)},url:a.Routing.generate('app_admin_drivers_getdata'),method:'GET'},columns:[{name:'name',title:'Nombre'},{title:'Móvil',searchable:!1,sortable:!1},{title:'Fijo',searchable:!1,sortable:!1},{name:'contactInfo',title:'Información de contacto',sortable:!1},{name:'isDriverGuide',title:'Driver guide',searchable:!1,width:'100px'},{title:'Acciones',searchable:!1,sortable:!1,width:'80px'}],bProcessing:!0,bServerSide:!0});t.on('click','.btn-delete',function(n){n.preventDefault();var i=e(this).attr('href'),r=e(this);a.swal({showCancelButton:!0,title:'Confirmar eliminación',text:'Se dispone a eliminar la información de un conductor. Todos los viajes realizados por este serán eliminados del sistema. ¿Desea continuar?',type:'warning'},function(a){if(a){r.closest('td').empty().text('Eliminando...');e.ajax({method:'POST',success:function(e){t.DataTable().draw(!1)},type:'json',url:i})}})})},i=function(){e('#collapseFilter select').on('change',function(){t.DataTable().draw()})};return{init:function(){n();i()}}}(jQuery,window));
;App=typeof App!=='undefined'?App:{};App.Locations=typeof App.Locations!=='undefined'?App.Locations:{};+(App.Locations.Form=function(n){var p=function(){App.Main.validate(n('form#location'))};return{init:function(){p()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Locations=typeof App.Locations!=='undefined'?App.Locations:{};+(App.Locations.Index=function(t){var a,o=function(a){a.preventDefault();t('.modal[data-for=dataTables-locations] button.btn-danger').data('url',t(a.currentTarget).attr('href'));t('.modal[data-for=dataTables-locations]').modal()},n=function(a){a.preventDefault();var o=t(this).data('url');t('#dataTables-locations').find('a[href="'+o+'"]').parents('td:first').empty().text('Eliminando...');t(this).parents('.modal:first').modal('hide');t.ajax(o,{method:'post',type:'json',success:function(t){location.href=location.href},error:function(){alert('Error ejecutando operación.');location.href=location.href}})},e=function(){t('.modal[data-for=dataTables-locations]').find('button.btn-danger').on('click',n)},i=function(){t(this).find('.btn-delete').on('click',o);t(this).find('[title]').tooltip({'trigger':'hover'});t(this).unblock()},r=function(){t(this).block({message:'Procesando...'})},d=function(){t('#dataTables-locations').on('draw.dt',i).on('preDraw.dt',r);a=App.Tables.initDatatable(t('#dataTables-locations'),{bProcessing:!1})};return{init:function(){d();e()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Places=typeof App.Places!=='undefined'?App.Places:{};+(App.Places.Form=function(n){var e=function(){n('form#place input[type=tel]').intlTelInput({allowExtensions:!0,autoFormat:!1,autoHideDialCode:!0,autoPlaceholder:!1,defaultCountry:'auto',geoIpLookup:function(e){n.get('http://ipinfo.io',function(){},'jsonp').always(function(n){var t=(n&&n.country)?n.country:'';e(t)})},nationalMode:!1,numberType:'MOBILE',preferredCountries:['cu'],utilsScript:'/plugins/jquery.intlTelInput/libphonenumber/build/utils.js'})},t=function(){App.Main.validate(n('form#place'))};return{init:function(){e();t()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Places=typeof App.Places!=='undefined'?App.Places:{};+(App.Places.Index=function(a){var t,e=function(t){t.preventDefault();a('.modal[data-for=dataTables-places] button.btn-danger').data('url',a(t.currentTarget).attr('href'));a('.modal[data-for=dataTables-places]').modal()},n=function(e){e.preventDefault();var n=a(this).data('url');a('#dataTables-places').find('a[href="'+n+'"]').parents('td:first').empty().text('Eliminando...');a(this).parents('.modal:first').modal('hide');a.ajax(n,{method:'post',type:'json',success:function(a){t.DataTable().draw(!1)},error:function(){alert('Error ejecutando operación.');t.DataTable().draw(!1)}})},o=function(){a('.modal[data-for=dataTables-places]').find('button.btn-danger').on('click',n)},d=function(){a(this).find('.btn-delete').on('click',e);a(this).find('[title]').tooltip({'trigger':'hover'});a(this).unblock()},l=function(){a(this).block({message:'Procesando...'})},r=function(){a('#dataTables-places').on('draw.dt',d).on('preDraw.dt',l);t=App.Tables.initDatatable(a('#dataTables-places'),{bProcessing:!1})},i=function(){if(a('.modal[data-for=flash]').length){a('.modal[data-for=flash]').modal()}};return{init:function(){r();o();i()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.ReservasClasicos=typeof App.ReservasClasicos!=='undefined'?App.ReservasClasicos:{};+(App.ReservasClasicos.Index=function(e,a){'use strict';var t=e('#dataTables-reservas'),n=function(){t.on('preDraw.dt',function(){e(this).block({message:'Cargando datos...'})}).on('draw.dt',function(){e(this).unblock();e(this).find('input:checkbox').iCheck({checkboxClass:'icheckbox_flat-blue'});e(this).find('tbody [title]').tooltip({'trigger':'hover'})});t.dataTable({ajax:{data:function(t){var a=[];e.each(e('form#formFilter').serializeArray(),function(e,t){a[t.name]=t.value});return e.extend(!0,t,a)},url:a.Routing.generate('app_reservasclasicos_getdata'),method:'GET',error:function(){a.alert('Error obteniendo datos de listado')}},columns:[{sortable:!1,searchable:!1,width:'24px'},{name:'state',title:'Estado',searchable:!1,sortable:!1},{name:'startat',title:'Fecha'},{name:'service',title:'Servicio'},{name:'client',title:'Cliente'},{name:'clientSerial',title:'Referencia del cliente'},{name:'provider',title:'Proveedor'},{name:'providerSerial',title:'Referencia del proveedor'},{name:'clientNames',title:'Nombre(s)'},{name:'pax',title:'Pax'},{searchable:!1,sortable:!1,width:'130px'}],serverSide:!0,searching:!1,sorting:[[2,'asc']]})},i=function(){t.on('click','.btn-delete',function(n){n.preventDefault();var i=e(this).attr('href'),o=e(this);a.swal({showCancelButton:!0,title:'Confirmar eliminación',text:'¿Seguro desea borrar esta reserva?',type:'warning'},function(a){if(a){o.closest('td').text('Eliminando...');e.ajax({method:'POST',success:function(e){t.DataTable().draw(!0)},dataType:'json',url:i})}})});t.on('click','.btn-execute',function(a){a.preventDefault();e('#_m').remove();var n=e('<div id="_m" class="modal fade" data-backdrop="static"><div class="modal-dialog"><div class="modal-content"/></div></div>');n.modal();n.find('.modal-content').load(e(this).attr('href'),function(){n.find('form').ajaxForm({beforePost:function(){n.find('button:submit').attr('disabled','disabled')},dataType:'json',success:function(e){n.modal('hide');t.DataTable().draw(!0)}})})});t.on('click','.btn-change-state',function(a){a.preventDefault();e('#_m').remove();var n=e('<div id="_m" class="modal fade" data-backdrop="static"><div class="modal-dialog"><div class="modal-content"/></div></div>');n.modal();n.find('.modal-content').load(e(this).attr('href'),function(){n.find('form').ajaxForm({beforePost:function(){n.find('button:submit').attr('disabled','disabled')},dataType:'json',success:function(e){n.modal('hide');t.DataTable().draw(!0)}})})})},o=function(){e('#link-select-all').on('click',function(e){e.preventDefault();t.find('input:checkbox').iCheck('check')});e('#link-select-none').on('click',function(e){e.preventDefault();t.find('input:checkbox').iCheck('uncheck')})},r=function(){e('#formFilter').find('input:text.datepicker').datepicker({format:'dd/mm/yyyy',autoclose:!0,closeBtn:!0,language:'es'});e('#formFilter').find('input:text.datepicker').on('changeDate',function(){t.DataTable().draw()});e('#formFilter input:text:not(.datepicker)').on('keyup',function(){t.DataTable().draw()})},c=function(t){if(t.length>0){e.swal({'title':'Notificaciones','text':t[0].replace(/\\n/g,'\n')})}};return{init:function(e){n();i();o();r();c(e)}}}(jQuery,window));
;App=typeof App!=='undefined'?App:{};App.ReservasGuia=typeof App.ReservasGuia!=='undefined'?App.ReservasGuia:{};+(App.ReservasGuia.Index=function(e,a){'use strict';var t=e('#dataTables-reservas'),n=function(){t.on('preDraw.dt',function(){e(this).block({message:'Cargando datos...'})}).on('draw.dt',function(){e(this).unblock();e(this).find('input:checkbox').iCheck({checkboxClass:'icheckbox_flat-blue'});e(this).find('tbody [title]').tooltip({'trigger':'hover'})});t.dataTable({ajax:{data:function(t){var a=[];e.each(e('form#formFilter').serializeArray(),function(e,t){a[t.name]=t.value});return e.extend(!0,t,a)},url:a.Routing.generate('app_reservasguia_getdata'),method:'GET',error:function(){a.alert('Error obteniendo datos de listado')}},columns:[{sortable:!1,searchable:!1,width:'24px'},{name:'state',title:'Estado',searchable:!1,sortable:!1},{name:'startat',title:'Fecha'},{name:'service',title:'Servicio'},{name:'client',title:'Cliente'},{name:'clientSerial',title:'Referencia del cliente'},{name:'provider',title:'Proveedor'},{name:'providerSerial',title:'Referencia del proveedor'},{name:'clientNames',title:'Nombre(s)'},{name:'pax',title:'Pax'},{searchable:!1,sortable:!1,width:'130px'}],serverSide:!0,searching:!1,sorting:[[2,'asc']]})},i=function(){t.on('click','.btn-delete',function(n){n.preventDefault();var i=e(this).attr('href'),o=e(this);a.swal({showCancelButton:!0,title:'Confirmar eliminación',text:'¿Seguro desea borrar esta reserva?',type:'warning'},function(a){if(a){o.closest('td').text('Eliminando...');e.ajax({method:'POST',success:function(e){t.DataTable().draw(!0)},dataType:'json',url:i})}})});t.on('click','.btn-execute',function(a){a.preventDefault();e('#_m').remove();var n=e('<div id="_m" class="modal fade" data-backdrop="static"><div class="modal-dialog"><div class="modal-content"/></div></div>');n.modal();n.find('.modal-content').load(e(this).attr('href'),function(){n.find('form').ajaxForm({beforePost:function(){n.find('button:submit').attr('disabled','disabled')},dataType:'json',success:function(e){n.modal('hide');t.DataTable().draw(!0)}})})});t.on('click','.btn-change-state',function(a){a.preventDefault();e('#_m').remove();var n=e('<div id="_m" class="modal fade" data-backdrop="static"><div class="modal-dialog"><div class="modal-content"/></div></div>');n.modal();n.find('.modal-content').load(e(this).attr('href'),function(){n.find('form').ajaxForm({beforePost:function(){n.find('button:submit').attr('disabled','disabled')},dataType:'json',success:function(e){n.modal('hide');t.DataTable().draw(!0)}})})})},o=function(){e('#link-select-all').on('click',function(e){e.preventDefault();t.find('input:checkbox').iCheck('check')});e('#link-select-none').on('click',function(e){e.preventDefault();t.find('input:checkbox').iCheck('uncheck')})},r=function(){e('#formFilter').find('input:text.datepicker').datepicker({format:'dd/mm/yyyy',autoclose:!0,closeBtn:!0,language:'es'});e('#formFilter').find('input:text.datepicker').on('changeDate',function(){t.DataTable().draw()});e('#formFilter input:text:not(.datepicker)').on('keyup',function(){t.DataTable().draw()})},c=function(t){if(t.length>0){e.swal({'title':'Notificaciones','text':t[0].replace(/\\n/g,'\n')})}};return{init:function(e){n();i();o();r();c(e)}}}(jQuery,window));
;App=typeof App!=='undefined'?App:{};App.ReservasMicrobus=typeof App.ReservasMicrobus!=='undefined'?App.ReservasMicrobus:{};+(App.ReservasMicrobus.Index=function(){var e=$('#dataTables-reservas'),t=function(){e.on('preDraw.dt',function(){$(this).block({message:'Cargando datos...'})}).on('draw.dt',function(){$(this).unblock();$(this).find('input:checkbox').iCheck({checkboxClass:'icheckbox_flat-blue'});$(this).find('tbody [title]').tooltip({'trigger':'hover'})});e.dataTable({ajax:{data:function(e){var t=[];$.each($('form#formFilter').serializeArray(),function(e,a){t[a['name']]=a['value']});return $.extend(!0,e,t)},error:function(){alert('Error obteniendo datos de listado')},method:'GET',url:Routing.generate('app_reservasmicrobus_getdata')},columns:[{sortable:!1,searchable:!1,width:'24px'},{name:'state',title:'Estado',searchable:!1,sortable:!1},{name:'startat',title:'Fecha'},{name:'service',title:'Servicio'},{name:'client',title:'Cliente'},{name:'clientSerial',title:'Referencia del cliente'},{name:'provider',title:'Proveedor'},{name:'providerSerial',title:'Referencia del proveedor'},{name:'clientNames',title:'Nombres'},{name:'pax',title:'Pax'},{searchable:!1,sortable:!1,width:'130px'}],searching:!1,serverSide:!0,sorting:[[2,'asc']]})},a=function(){e.on('click','.btn-delete',function(t){t.preventDefault();if(confirm('¿Seguro desea borrar esta reserva?')){var a=$(this).attr('href');$(this).closest('td').text('Eliminando...');$.ajax({method:'POST',success:function(t){e.DataTable().draw(!0)},dataType:'json',url:a})}});e.on('click','.btn-execute',function(t){t.preventDefault();$('#_m').remove();var a=$('<div id="_m" class="modal fade" data-backdrop="static"><div class="modal-dialog"><div class="modal-content"/></div></div>');a.modal();a.find('.modal-content').load($(this).attr('href'),function(){a.find('form').ajaxForm({beforePost:function(){a.find('button:submit').attr('disabled','disabled')},dataType:'json',success:function(t){a.modal('hide');e.DataTable().draw(!0)}})})});e.on('click','.btn-change-state',function(t){t.preventDefault();$('#_m').remove();var a=$('<div id="_m" class="modal fade" data-backdrop="static"><div class="modal-dialog"><div class="modal-content"/></div></div>');a.modal();a.find('.modal-content').load($(this).attr('href'),function(){a.find('form').ajaxForm({beforePost:function(){a.find('button:submit').attr('disabled','disabled')},dataType:'json',success:function(t){a.modal('hide');e.DataTable().draw(!0)}})})})},n=function(){$('#link-select-all').on('click',function(t){t.preventDefault();e.find('input:checkbox').iCheck('check')});$('#link-select-none').on('click',function(t){t.preventDefault();e.find('input:checkbox').iCheck('uncheck')})},i=function(){$('#formFilter input:text.datepicker').on('change',function(){e.DataTable().draw()}).datepicker({format:'dd/mm/yyyy',autoclose:!0,closeBtn:!0,language:'es'});$('#formFilter input:text:not(.datepicker)').on('keyup',function(){e.DataTable().draw()})},o=function(e){if(e.length>0){swal({'title':'Notificaciones','text':e[0].replace(/\\n/g,'\n')})}};return{init:function(e){t();a();n();i();o(e)}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.ReservasGuia=typeof App.ReservasGuia!=='undefined'?App.ReservasGuia:{};+(App.ReservasGuia.Form=function(e){'use strict';var r=function(){e.validator.addMethod('validdatetime',function(e,r){return this.optional(r)||/^([0-2]\d|3[0-1])\/(0\d|1[0-2])\/\d{4}\s([0-1]\d|2[0-3]):[0-5]\d$/.test(e)},'Valor no válido. Formato válido: DD/MM/YYYY HH:MM');e.validator.addMethod('endafterstart',function(r,o,i){var t='DD/MM/YYYY HH:mm',a=moment(e(i.startElement).val(),t),n=moment(r,t);if(!n.isValid()||!a.isValid()){return!0};return a.isBefore(n)},'Terminación no puede estar antes de o ser igual a inicio');App.Main.validate(e('form#reserva-tercero'),{'rules':{'reserva_tercero_form[startAt]':'validdatetime','reserva_tercero_form[endAt]':{'validdatetime':!0,'endafterstart':{'startElement':'#reserva_tercero_form_startAt'}}}})},t=function(){e('#reserva_tercero_form_startIn, #reserva_tercero_form_endIn').select2({ajax:{url:Routing.generate('app_reservasclasicos_getplaces'),dataType:'json',delay:250,data:function(e){return{q:e.term,page:e.page}}},language:'es',minimunInputLength:1,placeholder:'Seleccione un lugar',width:'resolve'});e('select[name="reserva_tercero_form[provider]"]').on('change',function(){var r=this.options[this.selectedIndex];if(e(r).data('show-provider-serial')){e('input:text[name="reserva_tercero_form[providerSerial]"]').closest('.form-group').fadeIn()}
else{e('input:text[name="reserva_tercero_form[providerSerial]"]').closest('.form-group').fadeOut(function(){e(this).find('input:text').val('')})}}).trigger('change')};return{init:function(){t();r()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.ReservasGuia=typeof App.ReservasGuia!=='undefined'?App.ReservasGuia:{};+(App.ReservasGuia.Form=function(e){'use strict';var r=function(){e.validator.addMethod('validdatetime',function(e,r){return this.optional(r)||/^([0-2]\d|3[0-1])\/(0\d|1[0-2])\/\d{4}\s([0-1]\d|2[0-3]):[0-5]\d$/.test(e)},'Valor no válido. Formato válido: DD/MM/YYYY HH:MM');e.validator.addMethod('endafterstart',function(r,o,i){var t='DD/MM/YYYY HH:mm',a=moment(e(i.startElement).val(),t),n=moment(r,t);if(!n.isValid()||!a.isValid()){return!0};return a.isBefore(n)},'Terminación no puede estar antes de o ser igual a inicio');App.Main.validate(e('form#reserva-tercero'),{'rules':{'reserva_tercero_form[startAt]':'validdatetime','reserva_tercero_form[endAt]':{'validdatetime':!0,'endafterstart':{'startElement':'#reserva_tercero_form_startAt'}}}})},t=function(){e('#reserva_tercero_form_startIn, #reserva_tercero_form_endIn').select2({ajax:{url:Routing.generate('app_reservasclasicos_getplaces'),dataType:'json',delay:250,data:function(e){return{q:e.term,page:e.page}}},language:'es',minimunInputLength:1,placeholder:'Seleccione un lugar',width:'resolve'});e('select[name="reserva_tercero_form[provider]"]').on('change',function(){var r=this.options[this.selectedIndex];if(e(r).data('show-provider-serial')){e('input:text[name="reserva_tercero_form[providerSerial]"]').closest('.form-group').fadeIn()}
else{e('input:text[name="reserva_tercero_form[providerSerial]"]').closest('.form-group').fadeOut(function(){e(this).find('input:text').val('')})}}).trigger('change')};return{init:function(){t();r()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.ReservasMicrobus=typeof App.ReservasMicrobus!=='undefined'?App.ReservasMicrobus:{};+(App.ReservasMicrobus.Form=function(e){var r=function(){e.validator.addMethod('validdatetime',function(e,r){return this.optional(r)||/^([0-2]\d|3[0-1])\/(0\d|1[0-2])\/\d{4}\s([0-1]\d|2[0-3]):[0-5]\d$/.test(e)},'Valor no válido. Formato válido: DD/MM/YYYY HH:MM');e.validator.addMethod('endafterstart',function(r,n,i){var t='DD/MM/YYYY HH:mm',a=moment(e(i.startElement).val(),t),o=moment(r,t);if(!o.isValid()||!a.isValid()){return!0};return a.isBefore(o)},'Terminación no puede estar antes de o ser igual a inicio');App.Main.validate(e('form#reserva-tercero'),{'rules':{'reserva_tercero_form[startAt]':'validdatetime','reserva_tercero_form[endAt]':{'validdatetime':!0,'endafterstart':{'startElement':'#reserva_tercero_form_startAt'}}}})},t=function(){e('#reserva_tercero_form_startIn, #reserva_tercero_form_endIn').select2({ajax:{url:Routing.generate('app_reservasmicrobus_getplaces'),dataType:'json',delay:250,data:function(e){return{q:e.term,page:e.page}}},language:'es',minimunInputLength:1,placeholder:'Seleccione un lugar',width:'resolve'});e('select[name="reserva_tercero_form[provider]"]').on('change',function(){var r=this.options[this.selectedIndex];if(e(r).data('show-provider-serial')){e('input:text[name="reserva_tercero_form[providerSerial]"]').closest('.form-group').fadeIn()}
else{e('input:text[name="reserva_tercero_form[providerSerial]"]').closest('.form-group').fadeOut(function(){e(this).find('input:text').val('')})}}).trigger('change')};return{init:function(){t();r()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Reservas=typeof App.Reservas!=='undefined'?App.Reservas:{};+(App.Reservas.Form=function(e){'use strict';var a,r=function(){if(e.validator){e.validator.addMethod('validdatetime',function(e,t){return this.optional(t)||/^([0-2]\d|3[0-1])\/(0\d|1[0-2])\/\d{4}\s([0-1]\d|2[0-3]):[0-5]\d$/.test(e)},'Valor no válido. Formato válido: DD/MM/YYYY HH:MM');e.validator.addMethod('endafterstart',function(t){var a=e('input[name="reserva[startAt]"]').val();if(!/^([0-2]\d|3[0-1])\/(0\d|1[0-2])\/\d{4}\s([0-1]\d|2[0-3]):[0-5]\d$/.test(t)||!/^([0-2]\d|3[0-1])\/(0\d|1[0-2])\/\d{4}\s([0-1]\d|2[0-3]):[0-5]\d$/.test(a)){return!0};var r=function(e){var t=e.split('/');return{date:t[2]+'-'+t[1]+'-'+t[0],number:t[2]+t[1]+t[0],year:t[2],month:t[1],day:t[0]}},i=function(e){var t=e.split(':');return{time:t[0]+':'+t[1],number:t[0]+t[1],hour:t[0],minute:t[1]}},n=function(e){var t=e.split(' '),n=r(t[0]),a=i(t[1]);return{datetime:n.date+' '+a.time,number:n.number+a.number}};return n(a).number<n(t).number},'Terminación no puede ser antes de o igual a inicio')}
else{console.log('Validator plugin not present')}},i=function(){a=App.Main.validate(e('form#reserva'),{rules:{'reserva[startAt]':'validdatetime','reserva[endAt]':'validdatetime endafterstart','reserva[pax]':{min:1}}});e('#reserva_form_startPlace, #reserva_form_endPlace').on('change',function(){e(this).valid()})},d=function(a){a.preventDefault();var i=e('#places-container'),s=i.data('prototype'),d=i.data('index'),r=e(s.replace(/__name__/g,d));i.data('index',d+1);i.append(r);r.find('select').select2(t());r.find('.select2-container').css('width','');r.find('.select2-selection').css('height','30px');r.find('.datepicker').datepicker({format:'dd/mm/yyyy',autoclose:!0});if(i.find('.item').length>1){r.find('.datepicker').datepicker('setDate',r.prev().find('.datepicker input').val())};r.find('button.btn-delete').on('click',n)},n=function(t){t.preventDefault();e(this).parents('.item:first').removeClass('item').fadeOut(function(){e(this).remove()})},s=function(){e('#places-container').data('index',e('#places-container .item').length);e('#linkAddPassingPlace').on('click',d);e('#places-container .datepicker').datepicker({format:'dd/mm/yyyy',autoclose:!0});e('#places-container').find('button.btn-delete').on('click',n);e('#places-container').find('select').select2(t());e('#places-container').find('.select2-selection').css('height','30px')},t=function(){return{ajax:{url:e('#reserva_form_startPlace').data('ajax'),dataType:'json',delay:250,data:function(e){return{q:e.term,page:e.page}}},language:'es',minimunInputLength:1,placeholder:'Seleccione un lugar',width:'resolve'}},o=function(){if(e.fn.select2){e('#reserva_form_startPlace, #reserva_form_endPlace').select2(t());e('.select2-container').css('width','')}
else{console.log('select2 plugin not present')}},c=function(){e('#reserva_form_isDriverConfirmed').iCheck({checkboxClass:'icheckbox_flat-blue'});e('.btn-test-printed-version').on('click',function(){var n=e(this).data('target').replace(/^\#/,''),a=CKEDITOR.instances[n].getData(),t=e('<form/>').appendTo(e('body')).attr({action:Routing.generate('app_reservas_testprintedversion'),method:'POST',target:'_blank'}).append(e('<input type="hidden" name="content"/>').val(a));t.submit();t.remove()})};return{init:function(){i();r();s();o();c()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Reservas=typeof App.Reservas!=='undefined'?App.Reservas:{};App.Reservas.Index=function(e){'use strict';var a,t=function(t){t.preventDefault();e('#modalExecute').remove();var n=e('<div class="modal fade" id="modalExecute" data-backdrop="static"><div class="modal-dialog"><div class="modal-content"></div></div></div>'),r=function(e){n.modal('hide');var t=n.data('row');t.find('td:last').empty().text('Ejecutando...');a.DataTable().draw(!1)};n.data('row',e(this).closest('tr'));n.find('.modal-content').load(e(this).attr('href'),function(){n.find('form').ajaxForm({dataType:'json',success:r});n.modal()})},n=function(a){a.preventDefault();var n=e(this);if(n.data('loading')){return}
else{n.data('loading',!0)};e('#modalExecute').remove();var t=e('<div class="modal fade" id="modalExecute" data-backdrop="static"><div class="modal-dialog"><div class="modal-content"/></div></div>'),r=function(e){t.modal('hide')};t.find('.modal-content').load(e(this).attr('href'),function(){t.find('form').ajaxForm({dataType:'json',success:r});t.modal();n.removeData('loading')})},r=function(a){a.preventDefault();e('.modal[data-for=dataTables-reservas] button.btn-danger').data('url',e(a.currentTarget).attr('href'));e('.modal[data-for=dataTables-reservas]').modal()},i=function(t){t.preventDefault();var n=e(this).data('url');e('#dataTables-reservas').find('a[href="'+n+'"]').parents('td:first').empty().text('Eliminando...');e(this).parents('.modal:first').modal('hide');e.ajax(n,{method:'post',type:'json',success:function(e){a.DataTable().draw(!1)},error:function(){window.alert('Error ejecutando operación.');a.DataTable().draw(!1)}})},o=function(){e('.modal[data-for=dataTables-reservas]').find('button.btn-danger').on('click',i)},c=function(a){a.preventDefault();e('.modal[data-for=cancel-op]').find('button.btn-warning').data('url',e(this).attr('href'));e('.modal[data-for=cancel-op]').modal()},s=function(t){t.preventDefault();var n=e(this).data('url');e('#dataTables-reservas').find('a[href="'+n+'"]').parents('td:first').empty().text('Cancelando...');e(this).parents('.modal:first').modal('hide');e.ajax(n,{method:'post',type:'json',success:function(e){a.DataTable().draw(!1)},error:function(){window.alert('Error ejecutando operación.');a.DataTable().draw(!1)}})},d=function(){e('.modal[data-for=cancel-op]').find('button.btn-warning').on('click',s)},l=function(){e(this).block({message:'Procesando...'})},f=function(){e(this).find('[title]').tooltip({'trigger':'hover'});e(this).find('input:checkbox').iCheck({checkboxClass:'icheckbox_flat-blue'});e(this).unblock()},u=function(i){var o=e('#dataTables-reservas');o.on('click','.btn-delete',r);o.on('click','.btn-cancel',c);o.on('click','.btn-execute',t);o.on('click','.btn-edit-issues',n);o.on('click','.btn-driver-confirm',m);o.on('draw.dt',f);o.on('preDraw.dt',l);a=o.dataTable({aoColumns:[{name:'selected',sortable:!1,searchable:!1},{name:'state',bSortable:!1,bSearchable:!1},{name:'startAt'},{name:'provider'},{name:'serialNumber'},{name:'providerReference'},{name:'clientNames'},{name:'pax',searchable:!1},{name:'serviceType'},{name:'driver',title:'Conductor'},{name:'guide',title:'Guía',searchable:!1,sortable:!1},{name:'issues',searchable:!1,sortable:!1},{bSortable:!1,bSearchable:!1,width:'170px'}],aaSorting:[[2,'asc']],ajax:{data:function(a){var t=[];e.each(e('form#filter').serializeArray(),function(e,a){if(/\[\]$/.test(a.name)){var n=a.name.replace(/\[\]$/,'');if(!t[n]){t[n]=[]};t[n].push(a.value)}
else{t[a.name]=a.value}});return e.extend(!0,a,t)},method:'GET',url:Routing.generate('app_reservas_getdata')},iDisplayLength:i.pageLength,oSearch:{'sSearch':i.search},serverSide:!0,processing:!1})},m=function(t){t.preventDefault();e(this).parents('td:first').empty().text('Confirmando...');e.ajax(e(this).attr('href'),{method:'post',success:function(){a.DataTable().draw(!1)}})},p=function(){e('#filter-form .datepicker').datepicker({autoclose:!0,clearBtn:!0,format:'dd/mm/yyyy',todayBtn:!0,todayHighlight:!0})},h=function(){p();e('#filter-form').find('input, select').on('change',function(){if(e(this).is('select[name="reserva_filter_form[isDriverAssigned][choice]"]')){if(e(this).val()==='with-drivers'){e('#filter-form [name="reserva_filter_form[isDriverAssigned][drivers][]"]').closest('div.row').show()}
else{e('#filter-form [name="reserva_filter_form[isDriverAssigned][drivers][]"]').closest('div.row').hide()}};a.DataTable().draw()});e('[name="reserva_filter_form[isDriverAssigned][drivers][]"], select[name="reserva_filter_form[serviceType][]"]','#filter-form').select2({width:'100%'})},v=function(t){t.preventDefault();if(a.find('input:checkbox:checked').length==0){return window.alert('Debe seleccionar registros para realizar esta operación')};var n=e('<form/>').attr({action:e(this).attr('href'),method:'post',target:'_blank'}).append(a.find('input:checkbox:checked').clone().attr('name','ids[]')).appendTo(e('body'));n.submit().remove()},b=function(t){t.preventDefault();if(a.find('input:checkbox:checked').length==0){return window.alert('Debe seleccionar registros para realizar esta operación')};var n=e('<form/>').attr({action:e(this).attr('href'),method:'post',target:'_blank'}).append(a.find('input:checkbox:checked').clone().attr('name','ids[]')).appendTo(e('body'));n.submit().remove()},k=function(){e('#link-select-all').on('click',function(e){e.preventDefault();a.find('input:checkbox').iCheck('check')});e('#link-select-none').on('click',function(e){e.preventDefault();a.find('input:checkbox').iCheck('uncheck')});e('a#linkPrintSelection').on('click',v);e('a#linkPrintSpecialReport').on('click',b)},g=function(e){if(e.length>0){swal({'title':'Notificaciones','text':e[0].replace(/\\n/g,'\n')})}};return{init:function(e){u(e);o();d();h();k();g(e.notices)}}}(jQuery);
;App=typeof App!=='undefined'?App:{};App.ServiceTypes=typeof App.ServiceTypes!=='undefined'?App.ServiceTypes:{};+(App.ServiceTypes.Form=function(e){var i=function(){e.validator.addMethod('validdecimal',function(e,i){return this.optional(i)||/^((.|,)\d{1,2}|\d+(|.(|\d{1,2})|,(\d{1,2})))$/.test(e)},'Valor no válido');App.Main.validate(e('form#servicetype'))},p=function(){e('input:checkbox[name="service_type_form[isMultiple]"]').iCheck({checkboxClass:'icheckbox_flat-blue'})};return{init:function(){i();p()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.ServiceTypes=typeof App.ServiceTypes!=='undefined'?App.ServiceTypes:{};+(App.ServiceTypes.Index=function(e){var p=function(){App.Tables.initDatatable(e('table#dataTables-servicetypes'));App.Tables.initDeleteButtonHandler(e('table#dataTables-servicetypes'))};return{init:function(){p()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.ThirdProviders=typeof App.ThirdProviders!=='undefined'?App.ThirdProviders:{};+(App.ThirdProviders.Index=function(e){var r=function(){App.Main.validate(e('form#provider'),{rules:{'third_provider_form[serialPrefix]':{required:{depends:function(){return e('input:checkbox[name="third_provider_form[isSerialGenerator]"]').prop('checked')}}}},messages:{'third_provider_form[serialPrefix]':{required:'Este campo es obligatorio si desea que el sistema genere los números de confirmación'}}})};return{init:function(){r()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.ThirdCobros=typeof App.ThirdCobros!=='undefined'?App.ThirdCobros:{};+(App.ThirdCobros.Index=function(e){var t=e('table#services'),r=function(){t.on('preDraw.dt',function(){e(this).block({message:'Cargando datos...'})}).on('draw.dt',function(){e(this).find('input:checkbox').iCheck({checkboxClass:'icheckbox_flat-blue'});e(this).unblock()});t.dataTable({aaSorting:[[2,'asc']],ajax:{data:function(t){var r=[];e.each(e('form#formFilter').serializeArray(),function(e,t){r[t['name']]=t['value']});return e.extend(!0,t,r)},error:function(e){alert('Error cargando datos\n\n'+e.statusText)},method:'GET',url:Routing.generate('app_thirdcobros_getdata')},columns:[{searchable:!1,sortable:!1,width:'22px'},{name:'service',title:'Servicio'},{name:'startat',title:'Fecha'},{name:'provider',title:'Proveedor'},{name:'providerreference',title:'Referencia del proveedor',sortable:!1},{name:'customer',title:'Cliente'},{name:'customerreference',title:'Referencia del cliente'},{name:'state',title:'Estado',searchable:!1,sortable:!1,width:'40px'},{name:'charge',title:'Importe',searchable:!1,sortable:!1}],lengthMenu:[10,50],processing:!1,searching:!1,serverSide:!0})},n=function(){e('a#link-select-all').on('click',function(e){e.preventDefault();t.find('input:checkbox').iCheck('check')});e('a#link-select-none').on('click',function(e){e.preventDefault();t.find('input:checkbox').iCheck('uncheck')});e('#btnPrepareCobro').on('click',function(){var r=e.map(t.find('input:checkbox:checked'),function(t){return e(t).val()});if(r.length===0){toastr.error('Seleccione servicios','Error',{timeout:5000});return!0};e.ajax({error:function(e){toastr.error('Error cargando datos','Error',{timeout:5000})},method:'GET',success:function(t){e.unblockUI();e('div.modal#_dV').remove();var r=e(t).appendTo(e('body')).attr('id','_dV');r.on('hide.bs.modal',function(){r.find('form').remove()});App.Main.validate(r.find('form'),{submitHandler:function(){r.find('form').ajaxSubmit({beforeSubmit:function(){r.find('button[type=submit]').attr('disabled','disabled').text('Creando pago...')},target:r.find('.modal-content')})}});r.modal()},url:Routing.generate('app_thirdcobros_cobrar',{id:r})})})},o=function(){e('form#formFilter').find('input:text[name$="[startAt][left_date]"], input:text[name$="[startAt][right_date]"]').datepicker({format:'dd/mm/yyyy',autoclose:!0,clearBtn:!0,language:'es'});e('#collapseFilter').find('input, select').on('change',function(){t.DataTable().draw()})};return{init:function(){r();n();o()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.ThirdPays=typeof App.ThirdPays!=='undefined'?typeof App.ThirdPays:{};+(App.ThirdPays.Index=function(e){'use strict';var t=e('table#pays'),n=function(){t.on('preDraw.dt',function(){e(this).block({message:'Cargando datos...'})}).on('draw.dt',function(){e(this).find('input:checkbox').iCheck({checkboxClass:'icheckbox_flat-blue'});e(this).unblock()});t.dataTable({aaSorting:[[2,'asc']],ajax:{data:function(t){var n=[];e.each(e('form#formFilter').serializeArray(),function(e,t){n[t['name']]=t['value']});return e.extend(!0,t,n)},error:function(e){alert('Error cargando datos\n\n'+e.statusText)},method:'GET',url:Routing.generate('app_thirdpays_getdata')},columns:[{searchable:!1,sortable:!1,width:'22px'},{name:'service',title:'Servicio'},{name:'startat',title:'Fecha'},{name:'provider',title:'Proveedor'},{name:'providerreference',title:'Referencia del proveedor',sortable:!1},{name:'customer',title:'Cliente'},{name:'customerreference',title:'Referencia del cliente'},{name:'state',title:'Estado',searchable:!1,sortable:!1,width:'40px'},{name:'charge',title:'Importe',searchable:!1,sortable:!1}],processing:!1,serverSide:!0})},a=function(){e('form#formFilter').find('input:text, select').on('change',function(){t.DataTable().draw()});e('form#formFilter').find('input[name$="[startAt][left_date]"], input[name$="[startAt][right_date]"]').datepicker({format:'dd/mm/yyyy',autoclose:!0,clearBtn:!0,language:'es'})},r=function(){e('a#link-select-all').on('click',function(e){e.preventDefault();t.find('input:checkbox').iCheck('check')});e('a#link-select-none').on('click',function(e){e.preventDefault();t.find('input:checkbox').iCheck('uncheck')});e('button#btnPreparePay').on('click',function(){var n=e.map(t.find('input:checkbox:checked'),function(t){return e(t).val()});if(n.length===0){toastr.error('Seleccione servicios','Error',{timeout:5000});return!0};e.blockUI({message:'Cargando datos...'});e.ajax({error:function(t){alert('Error cargando datos\n]n'+t.statusText);e.unblockUI()},method:'GET',success:function(t){e.unblockUI();e('div.modal').remove();var n=e(t).appendTo(e('body'));n.on('hide.bs.modal',function(){n.find('form').remove()});App.Main.validate(n.find('form'),{submitHandler:function(){n.find('form').ajaxSubmit({beforeSubmit:function(){n.find('button[type=submit]').attr('disabled','disabled').text('Creando pago...')},target:n.find('.modal-content')})}});n.modal()},url:Routing.generate('app_thirdpays_pay',{id:n})})})};return{init:function(){n();a();r()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Guides=typeof App.Guides!=='undefined'?App.Guides:{};+(App.Guides.Form=function(e){var p=function(){App.Main.validate(e('form#guide'))},i=function(){e('select[name="travel_guide[providers][]"]').select2({width:'100%'})};return{init:function(){p();i()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Guides=typeof App.Guides!=='undefined'?App.Guides:{};+(App.Guides.Index=function(a){var t,e=function(t){t.preventDefault();a('.modal[data-for=dataTables-guides] button.btn-danger').data('url',a(t.currentTarget).attr('href'));a('.modal[data-for=dataTables-guides]').modal()},d=function(e){e.preventDefault();var d=a(this).data('url');a('#dataTables-guides').find('a[href="'+d+'"]').parents('td:first').empty().text('Eliminando...');a(this).parents('.modal:first').modal('hide');a.ajax(d,{method:'post',type:'json',success:function(a){t.DataTable().draw(!1)},error:function(){alert('Error ejecutando operación.');t.DataTable().draw(!1)}})},n=function(){a('.modal[data-for=dataTables-guides]').find('button.btn-danger').on('click',d)},i=function(){a(this).find('.btn-delete').on('click',e);a(this).find('[title]').tooltip({'trigger':'hover'})},o=function(){t=App.Tables.initDatatable(a('#dataTables-guides'));a('#dataTables-guides').on('draw.dt',i)},r=function(){if(a('.modal[data-for=flash]').length){a('.modal[data-for=flash]').modal()}};return{init:function(){o();n();r()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Tables=function(a){var t=function(t,e){return a(t).each(function(){var t=a(this),r={aoColumns:[],responsive:!0,bServerSide:!1};if(t.data('serverside')){r.bProcessing=!0;r.bServerSide=!0;r.ajax={method:t.data('ajax-method')?t.data('ajax-method'):'post',url:t.data('ajax-url')}};r.aaSorting=[[t.data('sort-col')?t.data('sort-col'):0,t.data('sort-order')?t.data('sort-order'):'asc']];t.find('thead th').each(function(t){var e=a(this),n={};if(e.hasClass('no-sort')){n.bSortable=!1};if(e.hasClass('no-search')){n.bSearchable=!1};if(e.data('name')){n.name=e.data('name')};r.aoColumns[t]=n});t.dataTable(a.extend({},r,e))})},e=function(t){var e=a(t);if(e.find('.btn-delete').length&&a('.modal[data-for="'+e.attr('id')+'"]').length){e.find('.btn-delete').on('click',function(t){t.preventDefault();a('.modal[data-for="'+e.attr('id')+'"] .btn-danger').attr('href',a(this).attr('href'));a('.modal[data-for="'+e.attr('id')+'"]').modal()})}};return{initDatatable:t,initDeleteButtonHandler:e}}(jQuery);
;App=typeof App!=='undefined'?App:{};App.Users=typeof App.Users!=='undefined'?App.Users:{};App.Users.Index=function(e){var p=function(){App.Tables.initDatatable(e('table#dataTables-users'));App.Tables.initDeleteButtonHandler(e('table#dataTables-users'))};return{init:function(){p()}}}(jQuery);
;App=typeof App!=='undefined'?App:{};App.Users=typeof App.Users!=='undefined'?App.Users:{};App.Users.Form=function(e){var s=function(){App.Main.validate(e('form#user'),{rules:{'user[plainPassword][first]':{minlength:5},'user[plainPassword][second]':{minlength:5,equalTo:'#user_plainPassword_first'}},messages:{'user[plainPassword][second]':{equalTo:'Ls contraseñas no coinciden'}}})},n=function(s,n){if(e('#user_imageFile_delete').length>0){e('#user_imageFile_delete').prop('checked','clear'===n)}},i=function(){e('#user_imageFile_file').on('change',n)};return{init:function(){s();i()}}}(jQuery);
;App=typeof App!=='undefined'?App:{};App.Providers=typeof App.Providers!=='undefined'?App.Providers:{};+(App.Providers.Index=function(e){var p=function(){App.Tables.initDatatable(e('table#dataTables-providers'));App.Tables.initDeleteButtonHandler(e('table#dataTables-providers'))};return{init:function(){p()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Providers=typeof App.Providers!=='undefined'?App.Providers:{};+(App.Providers.Form=function(p){var e=function(){App.Main.validate(p('form#provider'))},i=function(){p('form#provider input:checkbox').iCheck({checkboxClass:'icheckbox_flat-blue'})};return{init:function(){e();i()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Prices=typeof App.Prices!=='undefined'?App.Prices:{};+(App.Prices.Index=function(e,t){'use strict';var a=e('table#table-x'),n=function(){a.DataTable().draw(!1);var n=e(this).val(),r=this.options[this.selectedIndex].text;e('#link-print').attr('href',n!==''?t.generate('app_prices_print',{id:n}):t.generate('app_prices_print'));e('#link-print').empty().append('<span class="fa fa-print"/> Imprimir precios'+(''!==n?' para '+r:''))},r=function(){e('#link-print').on('click',function(t){t.preventDefault();e('#modalPrint').remove();var a=e('<div class="modal fade" id="modalPrint"><div class="modal-dialog"><div class="modal-content"></div></div></div>').appendTo(e('body'));a.modal();a.find('.modal-content').load(e(this).attr('href'),function(){a.find('select').select2({'width':'100%'})})})},i=function(){e('form#filter select').on('change',n).select2({'width':'100%'})},o=function(){e('#table-x').on('preDraw.dt',function(){e(this).block({message:'Procesando...'})}).on('draw.dt',function(){e(this).unblock()});e('#table-x').dataTable({'aLengthMenu':[100,200],'language':{'sProcessing':'Procesando...','sLengthMenu':'Mostrar _MENU_ registros','sZeroRecords':'No se encontraron resultados','sEmptyTable':'Ningún dato disponible en esta tabla','sInfo':'Mostrando del _START_ al _END_ (de _TOTAL_)','sInfoEmpty':'Mostrando registros del 0 al 0 de un total de 0 registros','sInfoFiltered':'(filtrado de un total de _MAX_ registros)','sInfoPostFix':'','sSearch':'Buscar:','sUrl':'','sInfoThousands':',','sLoadingRecords':'Cargando...','oPaginate':{'sFirst':'Primero','sLast':'Último','sNext':'Siguiente','sPrevious':'Anterior'},'oAria':{'sSortAscending':': Activar para ordenar la columna de manera ascendente','sSortDescending':': Activar para ordenar la columna de manera descendente'}},'serverSide':!0,'ajax':{'url':t.generate('app_prices_getdata'),'method':'POST','data':function(t){return e.extend(!0,t,{'filter':{'provider':e('form#filter select').val()}})}},'aoColumns':[{'name':'name','title':'Servicio'},{'name':'cobrar','title':'Cobrar','width':'80px'},{'name':'pagar','title':'Pagar','width':'80px'}]})},s=function(){a.on('click','button.btn-clear-price',function(){var t=e('form#filter select').val()!==''?'':'0.00';e(this).closest('.input-group').find('input:text').val(t).trigger('change')});a.on('change','input:text',function(){if(e(this).data('xhr-saving')){e(this).data('xhr-saving').abort();e(this).removeData('xhr-saving')};var n=e.now(),a=e(this),r=e.ajax(t.generate('app_prices_save'),{beforeSend:function(){a.css('border-color','#cb0316')},dataType:'json',data:{id:e(this).data('id'),value:e(this).val(),now:n},method:'POST',success:function(e){a.val(e.value);a.removeData('xhr-saving').css('border-color','')},error:function(){window.alert('Error intentando guardar precio')}});e(this).data('xhr-saving',r)})};return{init:function(){i();r();o();s()}}}(jQuery,Routing));
;App=typeof App!=='undefined'?App:{};App.Pagos=typeof App.Pagos!=='undefined'?App.Pagos:{};+(App.Pagos.Index=function(a){var e,o=function(){if(a.fn.tooltip){a(this).find('[title]').tooltip({trigger:'hover'})};a(this).unblock();a(this).find('input:checkbox').iCheck({checkboxClass:'icheckbox_flat-blue'})},t=function(){var t=a('#dataTables-pays'),n={'aoColumns':[{'bSortable':!1,'bSearchable':!1},{'name':'startAt'},{name:'driver'},{name:'client'},{name:'providerReference'},{name:'serviceType'},{name:'charge','sortable':!1,'searchable':!1}],aaSorting:[[1,'asc']],'language':{'sProcessing':'Procesando...','sLengthMenu':'Mostrar _MENU_ registros','sZeroRecords':'No se encontraron resultados','sEmptyTable':'No hay pagos pendientes','sInfo':'Mostrando del _START_ al _END_ (de _TOTAL_)','sInfoEmpty':'Mostrando registros del 0 al 0 de un total de 0 registros','sInfoFiltered':'(filtrado de un total de _MAX_ registros)','sInfoPostFix':'','sSearch':'Buscar:','sUrl':'','sInfoThousands':',','sLoadingRecords':'Cargando...','oPaginate':{'sFirst':'Primero','sLast':'Último','sNext':'Siguiente','sPrevious':'Anterior'},'oAria':{'sSortAscending':': Activar para ordenar la columna de manera ascendente','sSortDescending':': Activar para ordenar la columna de manera descendente'}},'bServerSide':!0,'ajax':{data:function(e){var o=[];a.each(a('#frmFilter').serializeArray(),function(a,e){o[e['name']]=e['value']});return a.extend(!0,e,o)},'method':'post','url':t.data('ajax-url')}};t.on('draw.dt',o).on('preDraw.dt',function(){a(this).block({'message':'Procesando...'})});e=t.dataTable(n)},n=function(){if(a.validator){a.validator.addMethod('validdecimal',function(a,e){return this.optional(e)||/^((.|,)\d{1,2}|\d+(|.(|\d{1,2})|,(\d{1,2})))$/.test(a)},'Valor no válido')}
else{console.log('Validator plugin not present')}},r=function(){App.Main.validate(a('.modal[data-for=pay-op] form'))},i=function(e){e.preventDefault();if(a('#dataTables-pays').find('input:checkbox:checked').length==0){toastr.error('Debe seleccionar registros para esta operación','Error',{progressBar:!0,timeout:5000});return};var o=[];a('#dataTables-pays').find('input:checkbox:checked').each(function(){o.push(this.value)});a('.modal[data-for=pay-op] .modal-body').empty().text('Cargando información de servicios seleccionados...');a('.modal[data-for=pay-op]').modal();a('.modal[data-for=pay-op] div.modal-body').load(a(this).attr('href'),{ids:o},r)},s=function(e){e.preventDefault();a(this).parents('.modal-content:first').find('form').submit();a(this).off('click').text('Guardando información...')},c=function(e){e.preventDefault();var t=a(this).attr('href'),o=a('.modal[data-for=pay-op] form').clone();o.attr({action:t,method:'post',target:'_blank'}).appendTo(a('body')).submit();setTimeout(function(){o.remove()},100)},d=function(){a('.modal[data-for=pay-op] .btn-success').on('click',s);a('.modal[data-for=pay-op] .link-print').on('click',c)},l=function(e){e.preventDefault();a('#dataTables-pays input:checkbox').prop('checked',!0);a('#dataTables-pays input:checkbox').iCheck('update')},p=function(e){e.preventDefault();a('#dataTables-pays input:checkbox').prop('checked',!1);a('#dataTables-pays input:checkbox').iCheck('update')},u=function(){a('#linkPay').on('click',i);a('#linkSelectAll').on('click',l);a('#linkSelectNone').on('click',p)},f=function(){a('#modal-historico button.btn-primary').on('click',function(e){e.preventDefault();a('#modal-historico .modal-body form').submit();a('#modal-historico').modal('hide')});a('#modal-historico select').select2({language:'./i18n/es',width:'style'})},m=function(){a('#frmFilter input.datepicker').on('change',function(){e.DataTable().draw()}).datepicker({format:'dd/mm/yyyy',autoclose:!0});a('#frmFilter select').on('change',function(){e.DataTable().draw()})};return{init:function(){t();u();d();n();f();m()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Invoices=typeof App.Invoices!=='undefined'?App.Invoices:{};+(App.Invoices.Index=function(e){var a=function(){if(e.fn.tooltip){e(this).find('[title]').tooltip({trigger:'hover'})};e(this).unblock()},o=function(){e(this).block({'message':'Procesando...'})},t=function(){var t=e('#dataTables-invoices'),n={aoColumns:[{title:'Fecha',name:'createdat',searchable:!1},{title:'Número',name:'invoiceNumber'},{title:'Cliente',name:'provider'},{title:'Importe',name:'invoicedPrice',searchable:!1},{title:'Acciones',searchable:!1,sortable:!1,width:80}],aaSorting:[[0,'desc']],'language':{'sProcessing':'Procesando...','sLengthMenu':'Mostrar _MENU_ registros','sZeroRecords':'No se encontraron resultados','sEmptyTable':'No hay facturas creadas','sInfo':'Mostrando del _START_ al _END_ (de _TOTAL_)','sInfoEmpty':'Mostrando registros del 0 al 0 de un total de 0 registros','sInfoFiltered':'(filtrado de un total de _MAX_ registros)','sInfoPostFix':'','sSearch':'Buscar:','sUrl':'','sInfoThousands':',','sLoadingRecords':'Cargando...','oPaginate':{'sFirst':'Primero','sLast':'Último','sNext':'Siguiente','sPrevious':'Anterior'},'oAria':{'sSortAscending':': Activar para ordenar la columna de manera ascendente','sSortDescending':': Activar para ordenar la columna de manera descendente'}},bServerSide:!0,bProcessing:!1,ajax:{method:'POST',url:Routing.generate('app_invoices_getdata')}};t.on('draw.dt',a).on('preDraw.dt',o);datatable=t.dataTable(n)};return{init:function(){t()}}}(jQuery));
;App=typeof App!=='undefined'?App:{};App.Invoices=typeof App.Invoices!=='undefined'?App.Invoices:{};+(App.Invoices.Form=function(e){var o=function(){e.validator.addMethod('norepeatedservices',function(i,t,o){var n=[],r=!1;e('#invoice_form_lines select[name$="[service]"]').each(function(){var i=e(this).val();if(i){if(n.indexOf(i)!==-1){r=!0;return!1};n.push(i)}});return!r},'Hay servicios repetidos en la factura');App.Main.validate(e('form#invoice'),{ignore:':hidden:not([name="services"])',rules:{'services':{norepeatedservices:!0,min:{depends:function(){return e('#invoice_form_modelName').val()==='GENERAL'},param:1}}},messages:{services:{min:'Agregue servicios a la factura'}}})},i=function(){var i=e(this).select2('data');if(e('#invoice_form_modelName').val()==='ATRIO'){e('input:hidden[name$="[1][service]"]').val(e(this).val());e('input:hidden[name$="[1][serviceSerialNumber]"]').val(i[0].serialNumber)};e(this).closest('.item').find('input[name$="[serviceName]"]').val(i[0].serviceName);e(this).closest('.item').find('input[name$="[clientsName]"]').val(i[0].clientNames);e(this).closest('.item').find('input[name$="[clientReference]"]').val(i[0].reference);e(this).closest('.item').find('input[name$="[serviceSerialNumber]"]').val(i[0].serialNumber);e(this).closest('.item').find('input[name$="[totalPrice]"]').val(i[0].price).trigger('change')},n={ajax:{dataType:'json',delay:250,data:function(e){return{q:e.term,page:e.page}}},escapeMarkup:function(e){return e},templateResult:function(e){if(e.loading)return e.text;var n='<div class="select2-result-repository clearfix"><div class="select2-result-repository__title">'+e.text+'</div>';n+='<div class="select2-result-repository__description">';var i=[];if(e.clientNames){i.push('<strong>Clientes:</strong> '+e.clientNames)};if(e.reference){i.push('<strong>Referencia:</strong> '+e.reference)};if(e.price){i.push('<strong>Importe:</strong> '+e.price)};n+=i.join(' | ',i)+'</div></div>';return n},language:'es',minimunInputLength:1,width:'100%'};var r=function(){e('#invoice_form_provider').on('change',function(){e('#invoice_form_lines').find('.item').remove()}).select2({width:'100%'});e('#invoice_form_driver').select2({width:'100%'});e('#invoice_form_modelName').on('change',function(){if(e(this).val()==='ATRIO'){e('#fakedServices').removeClass('hidden').find('.panel-body').append(e('<div class="row item"><div class="col-sm-4 form-group"><label for="invoice_form_lines_0_service" class="required">Servicio</label><select id="invoice_form_lines_0_service" name="invoice_form[lines][0][service]" required="required"></select></div><div class="form-group col-sm-2"><label for="invoice_form_lines_0_meassurementUnit">Unidad</label><input type="text" id="invoice_form_lines_0_meassurementUnit" name="invoice_form[lines][0][meassurementUnit]" maxlength="49" value="Km" class="form-control"></div><div class="col-sm-2 form-group"><label for="invoice_form_lines_0_quantity">Cantidad</label><input type="number" id="invoice_form_lines_0_quantity" name="invoice_form[lines][0][quantity]" class="form-control text-right" required="required"></div><div class="col-sm-2 form-group"><label for="invoice_form_lines_0_unitPrice">Precio</label><input type="text" id="invoice_form_lines_0_unitPrice" name="invoice_form[lines][0][unitPrice]" class="form-control text-right" required="required"></div><div class="col-sm-2 form-group"><label for="invoice_form_lines_0_totalPrice" class="required">Importe</label><input type="text" id="invoice_form_lines_0_totalPrice" name="invoice_form[lines][0][totalPrice]" required="required" class="form-control text-right"></div><input type="hidden" id="invoice_form_lines_0_serviceName" name="invoice_form[lines][0][serviceName]"><input type="hidden" id="invoice_form_lines_0_clientsName" name="invoice_form[lines][0][clientsName]"><input type="hidden" id="invoice_form_lines_0_clientReference" name="invoice_form[lines][0][clientReference]"><input type="hidden" id="invoice_form_lines_0_serviceSerialNumber" name="invoice_form[lines][0][serviceSerialNumber]"><input type="hidden" id="invoice_form_lines_0_serviceSerialNumber" name="invoice_form[lines][0][notes]"></div><div class="row item"><div class="col-sm-4 form-group"><label for="invoice_form_lines_1_serviceName" class="required">Servicio</label><input id="invoice_form_lines_1_serviceName" name="invoice_form[lines][1][serviceName]" required="required" value="Horas de espera" class="form-control" readonly="readonly"></div><div class="form-group col-sm-2"><label for="invoice_form_lines_1_meassurementUnit">Unidad</label><input type="text" id="invoice_form_lines_1_meassurementUnit" name="invoice_form[lines][1][meassurementUnit]" maxlength="49" value="hora" class="form-control"></div><div class="col-sm-2 form-group"><label for="invoice_form_lines_1_quantity">Cantidad</label><input type="number" id="invoice_form_lines_1_quantity" name="invoice_form[lines][1][quantity]" class="form-control text-right" required="required"></div><div class="col-sm-2 form-group"><label for="invoice_form_lines_1_unitPrice">Precio</label><input type="text" id="invoice_form_lines_1_unitPrice" name="invoice_form[lines][1][unitPrice]" class="form-control text-right" required="required"></div><div class="col-sm-2 form-group"><label for="invoice_form_lines_1_totalPrice" class="required">Importe</label><input type="text" id="invoice_form_lines_1_totalPrice" name="invoice_form[lines][1][totalPrice]" required="required" class="form-control text-right"></div><input type="hidden" id="invoice_form_lines_1_service" name="invoice_form[lines][1][service]"><input type="hidden" id="invoice_form_lines_1_clientsName" name="invoice_form[lines][1][clientsName]"><input type="hidden" id="invoice_form_lines_1_clientReference" name="invoice_form[lines][1][clientReference]"><input type="hidden" id="invoice_form_lines_1_serviceSerialNumber" name="invoice_form[lines][1][serviceSerialNumber]"><input type="hidden" id="invoice_form_lines_1_serviceSerialNumber" name="invoice_form[lines][1][notes]"></div>'));e('#fakedServices').find('select[name$="[service]"]').on('change',i).select2(e.extend(!0,n,{ajax:{url:Routing.generate('app_invoices_getservices',{id:e('#invoice_form_provider').val()})}}));e('#invoice_form_lines').closest('.panel').addClass('hidden').find('.item').remove()}
else{e('#fakedServices').addClass('hidden').find('.item').remove();e('#invoice_form_lines').closest('.panel').removeClass('hidden')}}).trigger('change')},t=function(){var r=e('#invoice_form_lines');r.data('index',r.find('.item').length);r.on('click','.btn-delete-item',function(){e(this).closest('.item').fadeOut(function(){e(this).remove();e('input:hidden[name="services"]').val(r.find('.item').length)})});e('button.btn-add-item').on('click',function(){var t=r.data('index'),a=r.data('prototype').replace(/__name__/g,t),o=e(a);r.data('index',t+1);o.appendTo(r);e('input:hidden[name="services"]').val(r.find('.item').length);o.find('select[name$="[service]"]').on('change',i).select2(e.extend(!0,n,{ajax:{url:Routing.generate('app_invoices_getservices',{id:e('#invoice_form_provider').val()})}}))});r.find('select[name$="[service]"]').on('change',i).select2(e.extend(!0,n,{ajax:{url:Routing.generate('app_invoices_getservices',{id:e('#invoice_form_provider').val()})}}));var t=function(){var i=0;e.map(e('input[name$="[totalPrice]"]'),function(n){i+=e(n).val()?e(n).val()*1:0});e('input[name="invoice_form[totalCharge]"]').val(i.toFixed(2))};e('body').on('change','input[name$="[totalPrice]"]',function(){t()});e('body').on('change','input[name$="[quantity]"], input[name$="[unitPrice]"]',function(){var i=e(this).closest('.item'),n=i.find('input[name$="[unitPrice]"]'),r=i.find('input[name$="[quantity]"]');if(n.val()===''||r.val()===''||isNaN(r.val()*n.val())){if(e('#invoice_form_modelName').val()==='GENERAL'){var t=i.find('select[name$="[service]"]').select2('data');i.find('input[name$="[totalPrice]"]').val(t.length>0?t[0].price.toFixed(2):'0.00').trigger('change')}
else{i.find('input[name$="[totalPrice]"]').val('0.00').trigger('change')}}
else{var o=(n.val()*r.val()).toFixed(2);i.find('input[name$="[totalPrice]"]').val(o).trigger('change')}})};return{init:function(){o();r();t()}}}(jQuery));